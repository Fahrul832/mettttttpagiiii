<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Brain Love 3D üß†‚ù§Ô∏è</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@700;900&display=swap" rel="stylesheet">
    <style>
        /* --- RESET & BASE --- */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; touch-action: none; }
        
        body {
            margin: 0; height: 100vh; overflow: hidden;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            font-family: 'Nunito', sans-serif;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        /* --- 3D CONTAINER --- */
        .game-boy {
            width: 95%; max-width: 400px; height: 85vh;
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(20px);
            border-radius: 40px;
            border: 4px solid #fff;
            box-shadow: 
                0 20px 50px rgba(0,0,0,0.15),
                inset 0 0 0 2px rgba(255,255,255,0.5);
            display: flex; flex-direction: column;
            overflow: hidden; position: relative;
        }

        /* HEADER */
        .header {
            padding: 20px; text-align: center;
            border-bottom: 2px solid rgba(255,255,255,0.5);
        }
        .level-pill {
            background: #ff6b81; color: white;
            padding: 8px 20px; border-radius: 50px;
            font-weight: 900; font-size: 1.2rem;
            box-shadow: 0 5px 15px rgba(255, 107, 129, 0.4);
            display: inline-block;
        }

        /* GAME AREA */
        .stage {
            flex: 1; position: relative; width: 100%; height: 100%;
            display: flex; flex-direction: column; align-items: center;
            padding: 20px;
            transition: transform 0.3s;
        }
        .stage.hidden { display: none; }

        .question {
            font-size: 1.5rem; color: #2d3436; font-weight: 800;
            text-align: center; margin-bottom: 30px; z-index: 10;
            text-shadow: 2px 2px 0 rgba(255,255,255,0.5);
        }

        /* --- 3D OBJECTS (CLAY STYLE) --- */
        .obj {
            position: absolute; cursor: grab;
            display: flex; align-items: center; justify-content: center;
            font-size: 3.5rem;
            transition: transform 0.1s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 20;
        }
        .obj:active { cursor: grabbing; transform: scale(1.1); z-index: 100 !important; }

        /* BUTTONS PALSU */
        .btn-3d {
            background: #fff; border-radius: 20px;
            padding: 15px 25px; margin: 8px;
            font-weight: bold; color: #636e72;
            box-shadow: 
                8px 8px 16px #d1d9e6, 
                -8px -8px 16px #ffffff;
            cursor: pointer; display: inline-block;
            transition: 0.1s;
        }
        .btn-3d:active {
            box-shadow: inset 4px 4px 8px #d1d9e6, inset -4px -4px 8px #ffffff;
            transform: scale(0.98);
        }

        /* FEEDBACK TOAST */
        .toast {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0);
            background: #ff4757; color: white; padding: 15px 30px;
            border-radius: 50px; font-weight: bold; font-size: 1.2rem;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            z-index: 200; pointer-events: none; transition: 0.3s;
        }
        .toast.show { transform: translate(-50%, -50%) scale(1); animation: shake 0.4s; }

        /* LEVEL SPECIFIC */
        /* LVL 1 */
        .sun { font-size: 5rem; z-index: 5; top: 200px; left: 40%; position: absolute; }
        .cloud { font-size: 7rem; z-index: 10; color: #fff; filter: drop-shadow(0 10px 10px rgba(0,0,0,0.1)); }
        
        /* LVL 2 */
        .rock { font-size: 5rem; z-index: 20; }
        .hidden-item { position: absolute; font-size: 4rem; z-index: 1; top: 320px; left: 42%; cursor: pointer; transition: 0.3s; }
        
        /* LVL 4 */
        .door { font-size: 8rem; top: 180px; left: 35%; position: absolute; transition: 0.3s; }
        .door-open { transform: perspective(500px) rotateY(-40deg); }

        /* LVL 5 */
        .bar-container {
            width: 80%; height: 30px; background: #dfe6e9;
            border-radius: 15px; position: relative; margin-top: 50px;
            box-shadow: inset 2px 2px 5px rgba(0,0,0,0.1); overflow: visible;
        }
        .bar-fill { height: 100%; width: 10%; background: #ff6b81; border-radius: 15px; }
        .slider-knob {
            width: 50px; height: 50px; background: #fff; border-radius: 50%;
            position: absolute; top: -10px; left: 0;
            box-shadow: 0 5px 10px rgba(0,0,0,0.2);
            display: flex; align-items: center; justify-content: center; font-size: 1.5rem;
            cursor: grab;
        }

        /* MODAL MENANG */
        .win-overlay {
            position: absolute; top:0; left:0; width:100%; height:100%;
            background: rgba(255,255,255,0.9); z-index: 300;
            display: none; flex-direction: column; align-items: center; justify-content: center;
            backdrop-filter: blur(10px);
        }
        .next-btn {
            background: #2ed573; color: white; padding: 15px 40px; border-radius: 50px;
            border: none; font-size: 1.5rem; font-weight: bold;
            box-shadow: 0 10px 20px rgba(46, 213, 115, 0.4); cursor: pointer;
        }

        @keyframes shake { 0%,100%{transform:translate(-50%,-50%);} 25%{transform:translate(-60%,-50%);} 75%{transform:translate(-40%,-50%);} }
        @keyframes float { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-10px);} }

    </style>
</head>
<body>

    <div class="game-boy">
        <div class="header">
            <div class="level-pill">LEVEL <span id="lvlNum">1</span></div>
        </div>

        <div id="lvl1" class="stage">
            <div class="question">Mana mataharinya? Kok mendung sih?</div>
            
            <div class="sun">‚òÄÔ∏è</div>
            <div class="obj cloud" data-drag="true" style="top: 180px; left: 35%;">‚òÅÔ∏è</div>
            <div class="obj cloud" data-drag="true" style="top: 200px; left: 55%;">‚òÅÔ∏è</div>
        </div>

        <div id="lvl2" class="stage hidden">
            <div class="question">Siapa yang paling manis?</div>
            
            <div style="margin-bottom: 20px;">
                <div class="btn-3d" onclick="wrong('Gula bikin diabetes!')">üç¨ Permen</div>
                <div class="btn-3d" onclick="wrong('Kurang manis ah.')">üçØ Madu</div>
            </div>

            <div class="hidden-item" onclick="winLevel('Fani emang paling manis! ü•∞')">üë∏</div>
            <div class="obj rock" data-drag="true" style="top: 300px; left: 40%;">ü™®</div>
        </div>

        <div id="lvl3" class="stage hidden">
            <div class="question">Satukan cinta kita!</div>
            
            <div class="obj" id="heart1" data-drag="true" style="top: 200px; left: 20%; color: #ff6b81;">‚ù§Ô∏è</div>
            <div class="obj" id="heart2" data-drag="true" style="top: 250px; left: 60%; color: #ff6b81; filter: hue-rotate(40deg);">üß°</div>
        </div>

        <div id="lvl4" class="stage hidden">
            <div class="question">Masuk ke hatiku dong!</div>
            
            <div class="door" id="door" onclick="knockDoor()">üö™</div>
            <div class="obj" data-drag="true" onclick="wrong('Kunci palsu wlek!')" style="top: 350px; left: 10%; font-size: 3rem;">üîë</div>
            <div class="obj" data-drag="true" onclick="wrong('Gak mempan!')" style="top: 320px; left: 70%; font-size: 3rem;">üóùÔ∏è</div>
            
            <p style="position:absolute; bottom:20px; color:#aaa; font-size:0.9rem;">(Tips: Ketuk pintu yang sopan)</p>
        </div>

        <div id="lvl5" class="stage hidden">
            <div class="question">Seberapa besar sayang kamu?</div>
            
            <div class="bar-container">
                <div class="bar-fill" id="loveFill"></div>
                <div class="slider-knob" id="knob" style="left: 0;">‚ù§Ô∏è</div>
            </div>
            
            <div style="margin-top: 30px; font-size: 2.5rem; font-weight: 900; color: #ff6b81;" id="loveScore">0%</div>
        </div>

        <div class="toast" id="toast">Salah woy! üòú</div>

        <div class="win-overlay" id="winModal">
            <div style="font-size: 6rem; animation: float 2s infinite;">üèÜ</div>
            <h1 style="color:#2d3436; margin: 10px 0;">HEBAT!</h1>
            <p id="winMsg" style="color:#777; font-weight:bold; margin-bottom: 20px;">Kamu Jenius Cinta!</p>
            <button class="next-btn" onclick="nextLevel()">LANJUT ‚ñ∂</button>
        </div>

        <div class="win-overlay" id="finalModal">
            <div style="font-size: 6rem;">üëë‚ù§Ô∏è</div>
            <h1 style="color:#ff6b81;">TAMAT!</h1>
            <p style="color:#555; text-align:center; padding:0 20px;">
                Logika Fani jalan 100%.<br>Perasaan Fani jalan 1000%.
            </p>
            <a href="https://wa.me/62895622188096?text=Udah%20namatin%20Brain%20Love%203D!%20Level%20terakhir%20sayangnya%20jebol%20sampe%201000%25%20dong%20%F0%9F%98%8D%F0%9F%94%A5" 
               style="background:#25D366; color:white; padding:15px 30px; border-radius:50px; text-decoration:none; font-weight:bold; margin-top:20px;">
               KLAIM HADIAH üéÅ
            </a>
        </div>

    </div>

    <script>
        // --- PHYSICS ENGINE SEDERHANA (DRAG & DROP FIXED) ---
        let dragItem = null;
        let startX = 0, startY = 0;
        let initialLeft = 0, initialTop = 0;

        // Init Draggables
        document.querySelectorAll('[data-drag="true"]').forEach(el => {
            el.addEventListener('mousedown', dragStart);
            el.addEventListener('touchstart', dragStart, {passive: false});
        });

        // Event Listeners Global untuk kelancaran drag
        document.addEventListener('mousemove', dragMove);
        document.addEventListener('touchmove', dragMove, {passive: false});
        document.addEventListener('mouseup', dragEnd);
        document.addEventListener('touchend', dragEnd);

        function dragStart(e) {
            dragItem = e.target;
            
            // Get initial position
            const style = window.getComputedStyle(dragItem);
            initialLeft = parseFloat(style.left);
            initialTop = parseFloat(style.top);

            // Get pointer position
            if(e.type === 'touchstart') {
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
            } else {
                startX = e.clientX;
                startY = e.clientY;
            }
        }

        function dragMove(e) {
            if (!dragItem) return;
            e.preventDefault();

            let currentX, currentY;
            if(e.type === 'touchmove') {
                currentX = e.touches[0].clientX;
                currentY = e.touches[0].clientY;
            } else {
                currentX = e.clientX;
                currentY = e.clientY;
            }

            const dx = currentX - startX;
            const dy = currentY - startY;

            // Update posisi (Absolute positioning)
            dragItem.style.left = `${initialLeft + dx}px`;
            dragItem.style.top = `${initialTop + dy}px`;

            // Cek Logika Level 3 & 5 Realtime
            checkCollision();
        }

        function dragEnd() {
            if(!dragItem) return;
            
            // Cek Logika Level 1 & 2 (Pas dilepas)
            checkDropLogic();
            
            dragItem = null;
        }

        // --- LEVEL LOGIC ---
        let currentLevel = 1;
        let knocks = 0;

        function checkCollision() {
            // LEVEL 5: SLIDER
            if(currentLevel === 5 && dragItem.id === 'knob') {
                const container = document.querySelector('.bar-container');
                const rect = container.getBoundingClientRect();
                const knobRect = dragItem.getBoundingClientRect();
                
                // Hitung posisi relatif knob terhadap container
                let relativeX = knobRect.left - rect.left;
                
                // Visual Update
                let percent = Math.floor((relativeX / rect.width) * 100);
                if(percent < 0) percent = 0;
                
                // Allow overflow visual
                document.getElementById('loveFill').style.width = Math.min(100, percent) + "%";
                document.getElementById('loveScore').innerText = (percent * 2) + "%"; // Biar cepet naik

                if(percent > 110) { // Kalau ditarik paksa keluar kanan
                    winLevel("Waduh! Sayangnya tumpah-tumpah! 1000%!");
                    dragItem = null; // Stop drag
                }
            }

            // LEVEL 3: MERGE HEARTS
            if(currentLevel === 3) {
                const h1 = document.getElementById('heart1').getBoundingClientRect();
                const h2 = document.getElementById('heart2').getBoundingClientRect();
                
                // Jarak antar pusat
                const dist = Math.hypot(h1.x - h2.x, h1.y - h2.y);
                
                if(dist < 50) {
                    document.getElementById('heart1').style.display = 'none';
                    document.getElementById('heart2').innerText = "üíú"; // Hati gabungan
                    document.getElementById('heart2').style.filter = "none";
                    document.getElementById('heart2').style.transform = "scale(1.5)";
                    winLevel("Cinta kita menyatu! Eaa...");
                    dragItem = null;
                }
            }
        }

        function checkDropLogic() {
            // LEVEL 1: AWAN
            if(currentLevel === 1) {
                const clouds = document.querySelectorAll('.cloud');
                let moved = 0;
                clouds.forEach(c => {
                    const rect = c.getBoundingClientRect();
                    // Jika awan digeser ke pinggir layar
                    if(rect.left < 20 || rect.right > window.innerWidth - 20) moved++;
                });

                if(moved >= 1) winLevel("Cerah deh kayak senyum kamu!");
            }
        }

        function knockDoor() {
            if(currentLevel !== 4) return;
            knocks++;
            const door = document.getElementById('door');
            
            // Animasi Ketuk
            door.style.transform = "scale(0.95)";
            setTimeout(()=> door.style.transform = "scale(1)", 100);

            if(knocks >= 5) {
                door.classList.add('door-open');
                setTimeout(()=> winLevel("Masuk aja, gak dikunci kok buat kamu."), 500);
            }
        }

        // --- SYSTEM ---
        function wrong(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.classList.add('show');
            setTimeout(()=> t.classList.remove('show'), 1000);
        }

        function winLevel(msg) {
            // Mencegah double win trigger
            if(document.getElementById('winModal').style.display === 'flex') return;
            
            document.getElementById('winMsg').innerText = msg;
            document.getElementById('winModal').style.display = 'flex';
        }

        function nextLevel() {
            document.getElementById('winModal').style.display = 'none';
            document.getElementById(`lvl${currentLevel}`).classList.add('hidden');
            
            currentLevel++;
            if(document.getElementById(`lvl${currentLevel}`)) {
                document.getElementById(`lvl${currentLevel}`).classList.remove('hidden');
                document.getElementById('lvlNum').innerText = currentLevel;
                
                // Reset slider for lvl 5
                if(currentLevel === 5) {
                    // Re-init slider logic specifically handled in dragMove
                    // Perlu init knob event listener kalau belum (tapi sudah di global)
                    const knob = document.getElementById('knob');
                    knob.addEventListener('mousedown', dragStart); 
                    knob.addEventListener('touchstart', dragStart);
                }
            } else {
                document.getElementById('finalModal').style.display = 'flex';
            }
        }

    </script>
</body>
</html>